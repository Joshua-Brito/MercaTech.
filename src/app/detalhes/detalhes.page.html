<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/home"></ion-back-button>
    </ion-buttons>
    <ion-title>Produtos Cadastrados</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <div *ngIf="loading" class="ion-text-center ion-margin-top">
    <ion-spinner name="circles"></ion-spinner>
    <p>Carregando produtos...</p>
  </div>

  <div *ngIf="error" class="ion-text-center ion-margin-top">
    <ion-icon name="alert-circle-outline" color="danger" size="large"></ion-icon>
    <p class="ion-text-danger">Ocorreu um erro ao carregar os produtos.</p>
    <ion-button (click)="carregarProdutos()" fill="outline">Tentar Novamente</ion-button>
  </div>

  <div *ngIf="!loading && !error && produtos.length === 0" class="ion-text-center ion-margin-top">
    <ion-icon name="cube-outline" size="large"></ion-icon>
    <p>Nenhum produto cadastrado ainda.</p>
    <ion-button routerLink="/cadastro" expand="block">Cadastrar Novo Produto</ion-button>
  </div>

  <ion-grid *ngIf="!loading && !error && produtos.length > 0">
    <ion-row>
      <ion-col size="12" size-sm="6" size-md="4" size-lg="3" *ngFor="let produto of produtos">
        <ion-card class="product-card">
          <img [src]="produto.image || 'https://via.placeholder.com/200x200?text=Sem+Imagem'"
               alt="Imagem do Produto"
               class="product-image" />
          <ion-card-header>
            <ion-card-title>{{ produto.title | maiuscula }}</ion-card-title>
            <ion-card-subtitle>{{ produto.category }}</ion-card-subtitle>
          </ion-card-header>

          <ion-card-content>
            <div class="price-info">
              <span class="product-price">R$ {{ produto.price | number:'1.2-2' }}</span>
              <p class="installments-info">
                OU 10x de R$ {{ (produto.price / 10) | number:'1.2-2' }} sem juros
              </p>
            </div>
            <div class="product-options">
              <ion-chip *ngIf="produto.category === 'Teste'">
                <ion-label>Testando</ion-label>
              </ion-chip>
              </div>
          </ion-card-content>

          <ion-footer>
            <ion-toolbar>
              <ion-buttons slot="end">
                <ion-button fill="clear" color="primary">
                  <ion-icon name="cart"></ion-icon>
                  <ion-label>Comprar</ion-label>
                </ion-button>
              </ion-buttons>
            </ion-toolbar>
          </ion-footer>
        </ion-card>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>